ğŸ§± What is a Deployment Strategy in OpenShift?
A Deployment Strategy defines how new application versions are rolled out to replace the existing running version (Pods).
It controls how downtime, traffic, and rollbacks are managed during an update.

âš™ï¸ Common Deployment Strategies in OpenShift
OpenShift (and Kubernetes) supports multiple deployment strategies, mainly:
Rolling Strategy (default)
Recreate Strategy
Blue-Green Deployment
Canary Deployment

ğŸ”¹ 1. Rolling Strategy (Default in OpenShift)

ğŸ“˜ Description:
New Pods are created gradually while old Pods are terminated incrementally.
Ensures zero downtime.
The new version slowly replaces the old one, one batch at a time.

ğŸ§© How it works:
Starts new Pods with the new version.
Waits until they are ready (health checks OK).
Gradually terminates old Pods.
Keeps the service available during the rollout.

âœ… Use Case:
When you want zero downtime and your app can handle multiple versions simultaneously (stateless apps).

ğŸ”§ Example (DeploymentConfig):
strategy:
  type: Rolling
  rollingParams:
    intervalSeconds: 1
    updatePeriodSeconds: 1
    timeoutSeconds: 600
    maxUnavailable: 25%
    maxSurge: 25%
â± Key Parameters:
| Parameter        | Description                                 |
| ---------------- | ------------------------------------------- |
| `maxUnavailable` | % of Pods allowed to be down during rollout |
| `maxSurge`       | % of extra Pods allowed temporarily         |
| `timeoutSeconds` | Rollout timeout limit                       |

ğŸ”¹ 2. Recreate Strategy

ğŸ“˜ Description:
Stops all existing Pods first, then starts the new ones.
Causes downtime during deployment.
Useful for stateful applications or apps that canâ€™t handle multiple versions running at once.

ğŸ§© How it works:
All current Pods are terminated.
New Pods are created after the old ones stop.

âœ… Use Case:
Database updates.
Stateful apps or apps that use file locks or non-shareable resources.

ğŸ”§ Example:
strategy:
  type: Recreate

âš ï¸ Note:
Expect temporary downtime between old Pods stopping and new Pods starting.

ğŸ”¹ 3. Blue-Green Deployment

ğŸ“˜ Description:
Two separate environments (Blue and Green) exist:
Blue = current live version.
Green = new version to test.
After verifying Green deployment, traffic is switched from Blue â†’ Green (via Route or Service).

ğŸ§© How it works:
Deploy new version (Green) alongside the old (Blue).
Test the new version (Green) using internal URL.
Once verified, switch the Route to point to Green.
Optionally delete old Blue pods.

âœ… Use Case:
When you need safe and reversible deployments.
For production apps needing manual or gradual switching.

ğŸ”§ Example Commands:

# Deploy blue version
oc new-app myapp:blue --name=myapp-blue

# Deploy green version
oc new-app myapp:green --name=myapp-green

# Route traffic to green
oc patch route myapp -p '{"spec":{"to":{"name":"myapp-green"}}}'

âš™ï¸ Benefit:
Instant rollback: just switch Route back to Blue.

ğŸ”¹ 4. Canary Deployment

ğŸ“˜ Description:
Deploys a small percentage of traffic to the new version first.
If it performs well, gradually increases traffic until 100%.
Allows testing in real production with minimal risk.

ğŸ§© How it works:
Deploy the new version (Canary).
Route a small % of traffic to it.
Monitor metrics (errors, latency, etc.).
If stable â†’ increase traffic; else â†’ rollback.

âœ… Use Case:
For progressive delivery and A/B testing.
Large-scale apps where risk minimization is critical.

ğŸ”§ Example using OpenShift Routes:
# Two deployments
oc new-app myapp:v1 --name=myapp-stable
oc new-app myapp:v2 --name=myapp-canary

# Split traffic 90% (stable), 10% (canary)
oc set route-backends myapp myapp-stable=90 myapp-canary=10

ğŸ” Gradual shift:
# Increase canary share
oc set route-backends myapp myapp-stable=70 myapp-canary=30

ğŸ§¾ Comparison Summary
| Strategy       | Downtime             | Parallel Versions | Rollback Speed | Best For                                      |
| -------------- | -------------------- | ----------------- | -------------- | --------------------------------------------- |
| **Rolling**    | âŒ No                 | âœ… Yes             | âš¡ Medium       | Stateless apps needing zero downtime          |
| **Recreate**   | âœ… Yes                | âŒ No              | âš¡ Fast         | Stateful apps or DB migrations                |
| **Blue-Green** | âŒ (Switch time only) | âœ… Yes             | âš¡ Very Fast    | Production apps needing manual safe switch    |
| **Canary**     | âŒ No                 | âœ… Yes             | âš¡ Gradual      | Large-scale apps, testing new versions safely |

ğŸ§  Bonus: How to Check Deployment Strategy
To check how your app deploys:
oc get dc <deployment-name> -o yaml | grep strategy -A5

To update strategy:
oc patch dc myapp -p '{"spec":{"strategy":{"type":"Rolling"}}}'

ğŸš€ Real-World Flow Example (Rolling Update)
# Check existing deployment
oc get dc myapp

# Update image
oc set image dc/myapp myapp=image-registry.openshift-image-registry.svc:5000/demo/myapp:v2

# Watch rollout progress
oc rollout status dc/myapp

# Rollback if needed
oc rollout undo dc/myapp

